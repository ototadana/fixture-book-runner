テスト実行用 Excel ファイル作成方法
===================================

ここでは、FixtureBookRunner で実行するための Excel ファイルの記述方法を説明します。

FixtureBook 一般の記述ルールについて
------------------------------------
ここでは、FixtureBookRunner に特化した記述ルールを中心に説明しています。

FixtureBook 一般の記述ルールについては、
[FixtureBook 記述ルール](https://github.com/ototadana/fixture-book/blob/master/doc/FixtureBookReference.md)
を随時参照してください。


1. 基本的な記述項目
-------------------
FixtureBookRunner でテスト実行する際には、以下のように
**A.テストケース**、**D.パラメタ**、**E.取得データ**
の3つのセクションを記述します。

![基本的な記述項目](./images/Tutorial-01.png?raw=true)

### 記述内容
#### A.テストケース
A.テストケースには、テスト (もしくはテストデータ) の内容を一行の簡潔な文章として記述する。 
「～の場合は、～となる」という形式で、
テスト条件と予想結果をできるだけ短く記述するのがおすすめです。

#### D.パラメタ
D.パラメタには、テスト対象のシェルスクリプトやバッチファイルのパスと引数を記述する。

ポイント:
*   [パラメタは文字列のリストとして扱うため](https://github.com/ototadana/fixture-book/blob/master/doc/FixtureBookReference.md#string-int-%E7%AD%89%E3%81%AE%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88)、
    列名は **-** とする。
*   バッチファイルの場合も拡張子（.bat や .cmd）を省略せずに書く必要がある（省略するとエラーになる）。
*   引数は一つづつ別々の（下の）セルに記述する。
*   ${...} という形式で環境変数または設定ファイルで定義した変数の参照が可能。
    複数の場所でテスト実行することを考えると（例えば開発PC上やCIサーバ上など）、
    実行ファイルの格納ディレクトリに関しては変数指定するのががおすすめ。

#### E.取得データ
E.取得データには、テスト対象のシェルスクリプトやバッチファイルの予想実行結果を記述する。
列名として指定できるのは **exitCode**, **stdout**, **stderr** の3つ。
それぞれ、終了コード、標準出力の内容、標準エラー出力の内容の予想結果を記述する。

ポイント:
*   stdout や stderr 出力の内容に改行コードが含まれる場合は、予想結果セルでも改行を行う（セル内改行する）。
*   チェック不要な列/チェックしたくない列に関しては削除可能。
    例えば、終了コードのみチェックして、標準出力や標準エラー出力のチェックが不要な場合は、
    exitCode 列のみを残して他の列は削除すればよい。
*   「E.取得データ」セクション自体の記述も省略可能。  
    この場合「終了コードが 0 かどうか」についてのチェックのみが行われる


2. データベースアクセス
-----------------------
データベースアクセスに関しては、FixtureBook の標準機能がそのまま利用できます。
つまり、以下の２つのことができます。
*   **B.テストデータクリア条件** および **C.テストデータ** によるテストデータの投入
*   **F.更新後データ** によるデータベース状態のチェック

詳細については、[FixtureBook 記述ルール](https://github.com/ototadana/fixture-book/blob/master/doc/FixtureBookReference.md)
を参照してください。

また、テストサンプル（*-example.zip）の定義例もあわせてご参照ください。
